# WebShell PHP - Vygon WEB04

## Context

Anti-malware detection in `/tmp/systemd-private-3c47a8afe94a4b46afd912ac0ddc7bcb-php-fpm.service-DIdWKm/tmp/phpP93z1o` and `/tmp/phpP93z1o`.

 - We have seen detections on this server for a year now in the random path : `/tmp/phpXXXXXX`. Note that : `/tmp/phpP93z1o` is the same as previous detections.
 - That's the first time we have a detection with a similar file path: `/tmp/systemd-private-3c47a8afe94a4b46afd912ac0ddc7bcb-php-fpm.service-DIdWKm/tmp/phpP93z1o`. That's the first proof that the threat actors are improving.

## Backdoor

 - The backdoor is a WebShell PHP (PHP 5 only), thus we can prove that the threat actors identifies the PHP version.
 - It's working on Linux and Windows
 - It's a Chinese backdoor
 - It can't be open source backdoor, another proof that the threat actors are improving, because previous were open source backdoors
 - This one can generate reverse shells (another backdoor easier to detect but harder to trace) using different programming languages (powershell (for persistence by using registry keys), perl, c, php (with php functions, COM objects, ...))
 - The backdoor tries to compromise the database
 - It can also upload, download and delete files
 - We can see that there is a basic obfuscation used to bypass Antivirus softwares